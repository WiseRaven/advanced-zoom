// $npm_package_name - $npm_package_version ($npm_package_homepage)
+function(){"use strict";var t,e,i,o,a;function r(t){var e={top:0,left:0};if(!t.offsetParent)return e;do{e.left+=t.offsetLeft;e.top+=t.offsetTop}while(t=t.offsetParent);return e}function s(t,e){t.style.webkitTransform=e;t.style.msTransform=e;t.style.transform=e}function n(t,e){if(!("transition"in document.body.style))return e;t.addEventListener("transitionend",e);t.addEventListener("webkitTransitionEnd",e)}function d(){this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null;this._window=window;this._document=document;this._body=document.body}d.prototype.listen=function(){document.body.addEventListener("click",function(t){if(t.target.getAttribute("data-zoom")==="zoom")this._zoom(t)}.bind(this))};d.prototype._zoom=function(a){var r=a.target;if(!r||r.tagName!=="IMG"&&r.tagName!=="VIDEO"&&r.tagName!=="PICTURE")return;if(this._body.classList.contains("zoom-overlay-open"))return;if(a.metaKey||a.ctrlKey)return window.open(a.target.getAttribute("data-zoom-original")||a.target.currentSrc||a.target.src,"_blank");if(r.width>=window.innerWidth-h.OFFSET)return;this._activeZoomClose(true);this._activeZoom=new h(r);this._activeZoom.zoomMedia(r.tagName);t=this._scrollHandler.bind(this);e=this._clickHandler.bind(this);i=this._keyHandler.bind(this);o=this._touchStart.bind(this);this._window.addEventListener("scroll",t);this._document.addEventListener("click",e);this._document.addEventListener("keyup",i);this._document.addEventListener("touchstart",o);a.stopPropagation()};d.prototype._activeZoomClose=function(a){if(!this._activeZoom)return;if(a)this._activeZoom.dispose();else this._activeZoom.close();this._window.removeEventListener("scroll",t);this._document.removeEventListener("click",e);this._document.removeEventListener("keyup",i);this._document.removeEventListener("touchstart",o);this._activeZoom=null};d.prototype._scrollHandler=function(t){var e;if(this._initialScrollPosition===null)this._initialScrollPosition=window.scrollY;e=this._initialScrollPosition-window.scrollY;if(Math.abs(e)>=40)this._activeZoomClose()};d.prototype._keyHandler=function(t){if(t.keyCode==27)this._activeZoomClose()};d.prototype._clickHandler=function(t){t.stopPropagation();t.preventDefault();this._activeZoomClose()};d.prototype._touchStart=function(t){this._initialTouchPosition=t.touches[0].pageY;a=this._touchMove.bind(this);t.target.addEventListener("touchmove",a)};d.prototype._touchMove=function(t){if(Math.abs(t.touches[0].pageY-this._initialTouchPosition)>10){this._activeZoomClose();t.target.removeEventListener("touchmove",a)}};function h(t){this._fullHeight=this._fullWidth=this._overlay=this._targetMediaWrap=null;this._targetMedia=t;this._body=document.body}h.OFFSET=80;h._MAX_WIDTH=2560;h._MAX_HEIGHT=4096;h.prototype.zoomMedia=function(t){var e=this._targetMedia;var i=e.getAttribute("data-zoom-original")||e.currentSrc||e.src;e.classList.add("zoom-media-loading");if(t==="IMG"||t==="PICTURE"){var o=document.createElement("img");o.onload=function(){this._fullHeight=Number(o.height);this._fullWidth=Number(o.width);this._zoomOriginal();e.classList.remove("zoom-media-loading");e.removeAttribute("data-zoom-original")}.bind(this);o.src=i}else if(t==="VIDEO"){var a=document.createElement("video");var r=document.createElement("source");var s=this;a.appendChild(r);a.addEventListener("canplay",function(){s._fullHeight=Number(a.videoHeight);s._fullWidth=Number(a.videoWidth);s._zoomOriginal();s._targetMedia.play();s._targetMedia.classList.remove("zoom-media-loading")},false);r.src=i}e.src=i};h.prototype._zoomOriginal=function(){this._targetMediaWrap=document.createElement("div");this._targetMediaWrap.className="zoom-media-wrap";this._targetMedia.parentNode.insertBefore(this._targetMediaWrap,this._targetMedia);this._targetMediaWrap.appendChild(this._targetMedia);this._targetMedia.classList.add("zoom-media");this._targetMedia.setAttribute("data-zoom","zoom-out");this._overlay=document.createElement("div");this._overlay.className="zoom-overlay";document.body.appendChild(this._overlay);this._calculateZoom();this._triggerAnimation()};h.prototype._calculateZoom=function(){this._targetMedia.offsetWidth;var t=this._fullWidth;var e=this._fullHeight;var i=window.scrollY;var o=t/(this._targetMedia.width||this._targetMedia.videoWidth);var a=window.innerHeight-h.OFFSET;var r=window.innerWidth-h.OFFSET;var s=t/e;var n=r/a;if(t<r&&e<a)this._mediaScaleFactor=o;else if(s<n)this._mediaScaleFactor=a/e*o;else this._mediaScaleFactor=r/t*o};h.prototype._triggerAnimation=function(){this._targetMedia.offsetWidth;var t=r(this._targetMedia),e=window.scrollY;var i=e+window.innerHeight/2,o=window.innerWidth/2,a=t.top+(this._targetMedia.height||this._targetMedia.offsetHeight)/2,n=t.left+(this._targetMedia.width||this._targetMedia.offsetWidth)/2;this._translateY=Math.round(i-a);this._translateX=Math.round(o-n);var d="scale("+this._mediaScaleFactor+")",h="translate("+this._translateX+"px, "+this._translateY+"px) translateZ(0)";s(this._targetMedia,d);s(this._targetMediaWrap,h);this._body.classList.add("zoom-overlay-open")};h.prototype.close=function(){this._body.classList.remove("zoom-overlay-open");this._body.classList.add("zoom-overlay-transitioning");s(this._targetMedia,"");s(this._targetMediaWrap,"");n(this._targetMedia,this.dispose.bind(this))};h.prototype.dispose=function(){if(this._targetMediaWrap&&this._targetMediaWrap.parentNode){this._targetMedia.classList.remove("zoom-media");this._targetMedia.setAttribute("data-zoom","zoom");this._targetMediaWrap.parentNode.replaceChild(this._targetMedia,this._targetMediaWrap);this._overlay.parentNode.removeChild(this._overlay);this._body.classList.remove("zoom-overlay-transitioning");if(this._targetMedia.tagName==="VIDEO"&&this._targetMedia.getAttribute("data-zoom-play")==="always")this._targetMedia.play()}};(new d).listen()}();
